<div class="search-filter-container">
  <!-- Barre de recherche -->
  <div class="search-bar" *ngIf="showSearch">
    <div class="search-input-container">
      <input 
        type="text" 
        class="search-input"
        [(ngModel)]="searchTerm"
        [placeholder]="searchPlaceholder"
        (input)="onSearchChange()"
      />
      <button 
        *ngIf="searchTerm" 
        class="clear-button" 
        title="Effacer la recherche"
        (click)="searchTerm = ''; onSearchChange()"
      >
        <svg xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 0 24 24" width="16px" fill="currentColor">
          <path d="M0 0h24v24H0z" fill="none"/>
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <button 
        class="search-button" 
        title="Rechercher"
      >
        <svg xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 0 24 24" width="16px" fill="currentColor">
          <path d="M0 0h24v24H0z" fill="none"/>
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
      </button>
    </div>

    <!-- Bouton de filtres -->
    <button 
      class="filter-toggle-button" 
      [class.has-filters]="hasActiveFilters"
      (click)="toggleFilters()"
      title="Filtres"
    >
      <svg xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 0 24 24" width="16px" fill="currentColor">
        <path d="M0 0h24v24H0z" fill="none"/>
        <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
      </svg>
      <span>Filtres</span>
      <span class="filter-badge" *ngIf="hasActiveFilters"></span>
    </button>
  </div>

  <!-- Zone de filtres -->
  <div class="filters-area" *ngIf="showFilters">
    <div class="filters-header">
      <h4>Filtres</h4>
      <button 
        class="reset-button" 
        (click)="resetAll()"
        title="Réinitialiser les filtres"
      >
        Réinitialiser
      </button>
    </div>

    <div class="filters-list">
      <!-- Filtres de type texte -->
      <div class="filter-item" *ngFor="let filter of filterOptions">
        <label [for]="'filter-' + filter.key">{{ filter.label }}</label>
        
        <!-- Input texte -->
        <input 
          *ngIf="filter.type === 'text'" 
          type="text" 
          [id]="'filter-' + filter.key"
          [value]="filter.value || ''" 
          (input)="onFilterChange(filter.key, getInputValue($event))"
        />
        
        <!-- Select -->
        <select 
          *ngIf="filter.type === 'select'" 
          [id]="'filter-' + filter.key"
          [value]="filter.value" 
          (change)="onFilterChange(filter.key, getInputValue($event))"
        >
          <option value="">Tous</option>
          <option *ngFor="let opt of filter.options" [value]="opt.value">{{ opt.label }}</option>
        </select>
        
        <!-- Input date -->
        <input 
          *ngIf="filter.type === 'date'" 
          type="date" 
          [id]="'filter-' + filter.key"
          [value]="filter.value || ''" 
          (input)="onFilterChange(filter.key, getInputValue($event))"
        />
        
        <!-- Checkbox -->
        <div class="checkbox-container" *ngIf="filter.type === 'boolean'">
          <input 
            type="checkbox" 
            [id]="'filter-' + filter.key"
            [checked]="filter.value === true" 
            (change)="onFilterChange(filter.key, getCheckboxValue($event))"
          />
          <label [for]="'filter-' + filter.key" class="checkbox-label"></label>
        </div>
        
        <!-- Range -->
        <div class="range-inputs" *ngIf="filter.type === 'range'">
          <input 
            type="number" 
            [id]="'filter-min-' + filter.key"
            [value]="getRangeValue(filter.value, 'min')" 
            placeholder="Min"
            (input)="updateRangeMin($event, filter.key)"
          />
          <span>à</span>
          <input 
            type="number" 
            [id]="'filter-max-' + filter.key"
            [value]="getRangeValue(filter.value, 'max')" 
            placeholder="Max"
            (input)="updateRangeMax($event, filter.key)"
          />
        </div>
      </div>
    </div>
  </div>
</div>
